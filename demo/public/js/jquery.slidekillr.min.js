(function($) {
    $.fn.SlideKillr=function(options) {

        var defauts= {
            "interval": 3000,
            "transitionSpeed": 1000,
            "transitionEffect": "fade",
            "indicators": true,
            "indicatorsPosition":"outside",
            "indicatorsColor":"#fff",
            "arrows": true,
            "arrowsPosition":"inside",
            "caption": true,
            "captionType":"basic",
	    "captionBackground":"#000",
	    "captionBackgroundOpacity":"0.9",
	    "captionColor":"#fff",
        };  
        var params=$.extend(defauts, options); 

        function generateIndicator(elt, params) {
            var indicators = $('<ol></ol>').addClass('sk_'+params.indicatorsPosition);
            for (i = 0; i < $(elt).find('.sk_item_container').length; i++) {
                $(indicators).append($('<li></li>').data('sk-to', i));
            }
            console.log($(indicators));
            $(elt).append($(indicators));
        }
	
	function generateCaption(elt, params) {
	    if (params.caption) {
		$(elt).find('.sk_caption').addClass('sk_'+params.indicatorsPosition);
		$(elt).find('.sk_'+params.indicatorsPosition).css('color', params.captionColor);
		$(elt).find('.sk_'+params.indicatorsPosition).css('background-color', params.captionBackground);
	    } else {
		$(elt).find('.sk_caption').css('display', 'none');
            }
	}

	function generateControls(elt, params) {
		if (params.arrows) {
		    var controlLeft = $('<span class="sk_control left"><</span>').addClass('sk_control_'+params.arrowsPosition);
		    var controlRight = $('<span class="sk_control right">></span>').addClass('sk_control_'+params.arrowsPosition);
		    $(elt).append($(controlLeft));
		    $(elt).append($(controlRight));
		}
	}

        return this.each(function() {
            if (params.indicators) {
                generateIndicator(this, params);
            }

	    generateCaption(this, params);

	    generateControls(this, params);
	    
        });
    };
})(jQuery);
